<!DOCTYPE HTML>
<html lang="ru">
	<head>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QPB2DJ');</script>
        <!-- End Google Tag Manager -->
		<meta charset="utf-8">
			<title>Знаменитая функция ВПР</title>
			<link rel="stylesheet" type="text/css" href="css/reset.css">
			<link rel="stylesheet" type="text/css" href="css/style-main.css">
            <link rel="stylesheet" href="css/YouTubePopUp.css">
			<link rel="shortcut icon" href="images/minlogo.png" type="image/png">
			<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
            <meta name="keywords" content="эксель, формулы, ВПР, статьи, excel, office, функции, условное форматирование, удалить дубликаты">
            <meta name="description" content='Одна из наиболее популярных и востребованных функций в excel. Позволяет перенести данные из разных локаций, используя уникальное значение в строке.'>
	</head>
	<body>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QPB2DJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
		<div class="wrapper">
    		<div class="header">
    			<div class="logo"><a href="index.html"><img src="images/logo-main.png" alt="logo"></a></div>

    			<nav>
    			    <a class="menu-trigger">меню</a>
    				<ul>
                        <li><a href="photo-portfolio.html">фото портфолио</a></li>
                        <li><a href="adobe.html">тонкости Adobe</a></li>
                        <li><a href="office-works.html" class="active">работа с Office</a></li>
                        <li><a href="my-blog.html">Мой блог</a></li>
                        <li><a href="aboutIT.html">около IT</a></li>
                        <li><a href="qa.html">тестирование ПО</a></li>
                    </ul>
    			</nav>
    		</div>
		
    		<div class="content">
                <div class="wrap-office-article">
                    
                    <article class="office-articles">
                        <h2>Знаменитая функция ВПР</h2>
                        
                        <div class="full-text-article-office">
                        
                        <p>Я расскажу о тонкостях и небольших особенностях использования функции ВПР (в английском варианте VLOOKUP) на одном примере. У нас есть таблица, в которой мы расчитываем план по сотрудникам по формуле "факт + 12%" (см. табл.1). Данные с фактом выполнения у нас находятся в другой таблице (табл.2). При этом, ФИО идут не по порядку. Задача перенести факт продаж в столбцах из таблицы 2 в таблицу 1.</p>
                        <p><img src="images/articles/vlookup.jpg"></p>
                        <p class="caption">табл.1</p>
                        
                        <p><img src="images/articles/vlookup2.jpg"></p>
                        <p class="caption">табл.2</p>

                        <h2>Важно!</h2>
                        <p>Функция производит поиск по столбцам. Если необходимо провести поиск по строкам, есть аналогичная функция ГПР.</p>
                        <p>Функция ВПР отрабатывает корректно только в том случае, когда есть совпадающие уникальные данные в обеих таблицах.
                        Расскажу по порядку. В графе ФИО есть фамилии в обеих таблицах. Это наш якорь, за который будем цеплять данные. Если в таблице 1 будет фамилия, например, Коздик П.А., а в таблице 2 (откуда мы берем исходные данные), такой фамилии нет, соответственно вместо данных в первой таблице мы получим "#Н/Д".</p>
                        <p>Эти фамилии (в других примерах, любые другие данные от цифр до дат) должны быть уникальными, то есть неповторяющимися. В противном случае, ВПР подтянет данные по первому совпадающему значению, проигнорировав второе. Например, в таблице 2 есть два одинаковых ФИО "Кириллов Б.А." (то есть, полностью идентичные), но с разными данными в ячейках "факт". При использовании ВПР в первой таблице подтянуться данные только первого Кириллова Б.А. А данные по второму Кириллову будут проигнорированы. Соответственно, если значения, на которые вы будете опираться, не уникальны, ВПР Вам не поможет. Обратите внимание, что значения должны точно совпадать, учитывая пробелы. Например, в ФИО первой таблицы Фамилии начинаются с буквы, а во второй таблице перед первой буквой фамилии стоит пробел, то такие значения совпадать не будут.</p>
                        <p>Кстати, как проверить, есть ли повторяющиеся значения в ячейках? Очень просто! Выделяете столбик со значениями. В меню "Главное" нажимаете на "Условное форматирование". В нем выбираете "Правила выделения ячеек" и там "Повторяющиеся значения".</p>

                        <p><img src="images/articles/vlookup3.jpg"></p>

                        <p>Программа предложит Вам выбрать каким цветом будут подсвечены повторяющиеся значения. Также, вместо повторяющихся, вы можете выделить уникальные значения.</p>

                        <p><img src="images/articles/vlookup4.jpg"></p>

                        <p>А если среди множества данных Вам нужно удалить повторяющиеся значения? Например, Вы точно уверены, что все строки у таких данных совпадают. И дубликаты нужно просто удалить. В этом случае, условное форматирование не очень эффективно. Если выбрать под фильтром все выделенные строки и удалить, то мы избавимся не только от дубликатов, но и от уникальных значений. А нам нужно оставить, к примеру, из трех повторяющихся одно значение. На помощь приходит отличная кнопочка "удалить дубликаты". Перед этим мы выделяем всю таблицу!!! Если в таблице есть объедененные ячейки, то удалить дубликаты не получится. Нужно либо снимать объединение, либо, как в моем случае (объеденные ячейки находятся в шапке таблицы) просто исключить из выделения. Далее, переходим на вкладку "данные". В ней кликаем по "удалить дубликаты". В новом окне я выбираем столбец А с повторяющимися значениями. Нажимаем ОК. И программа сообщает о том, сколько было удалено дубликатов и количество уникальных значений. Таким образом, всего за несколько секунд мы избавились от строк, которые мешают ВПР.</p>

                        <p><img src="images/articles/vlookup5.jpg"></p>

                        <p>Вернемся к нашей функции. Еще стоит помнить об одном моменте. Когда Вы выбираете исходную таблицу, уникальные значения должны быть первым столбцом в выделении. То есть, даже если в таблице 2 перед ФИО идут дургие столбцы, например, порядковый номер, должность и прочее, то при выборе исходной таблицы, вы выделяете, начинаяя с ФИО!!! В противном случае, ВПР откажется работать. А также, формат данных ФИО в обеих таблицах должен совпадать. Например, если в столбце ФИО таблицы 1 формат числовой, а в таблице 2 текстовый, то ВПР выдаст ошибку.</p>

                        <p>Разберем структуру функции и ее параметры</p>
                        <pre class="code">=ВПР(искомое значение;таблица;номер_столбца;[интервальный просмотр])</pre>
                        <p>Искомое значение - тот самый уникальный якорь. В нашем примере (пишем формулу в ячейке B3 таблицы 1) искомое значение А3. Сразу предвидим, будем ли мы протягивать формулу по горизонтали. Если да, то нам надо закрепить столбец А, который не будет меняться ни при каких условиях. Для этого нажимаем <kbd>F4</kbd> до тех пор, пока знак доллара не закрепиться только перед столбцом А. Обратите внимание, все условия разделены точкой с запятой, кроме последнего).</p>
                        <pre class="code">=ВПР($А3;таблица;номер_столбца;[интервальный просмотр])</pre>
                        <p class="ps-text">Опубликовано: <time datetime="2017-04-26T23:05">26.04.2017</time></p>

                        <p>Таблица - исходная таблица, из которой мы будем брать данные. В нашем случае, таблица 2, которая находится на другом листе этой же книги. Можно путь к таблице набрать вручную. Но, мы просто, после первого условия и точки с запятой, перейдем на закладку с таблицой 2 и выделим всю таблицу (обычно, я выделяю все столбцы таблицы, вдруг, в будущем появятся новые строки, в этом случае, нам не придется переписывать формулу). Таблицу обязательно закрепим (когда мы будем протягивать формулу, исходная таблица не должна сдвигаться ни в какую сторону). Для этого, перед значениями столбцов таблицы поставим знак доллара. Я делаю проще. Перешла на лист с исходной таблицей, выделила нужные столбцы, нажала <kbd>F4</kbd> один раз. Вся таблица закреплена:</p>

                        <p><img src="images/articles/vlookup6.jpg"></p>

                        <p>Выше на картинке вы видите "Лист4!" - это тот самый путь до нашей таблицы. Так в эксель обозначают лист 4. Таблица, к слову, может находиться и в другой книге. Чтобы не запоминать правила написания пути, просто, после набора исходного значения и точки с запятой, переходите в новую книгу, где хранится таблица, эксель сам пропишет путь до нее. Вам останется только выделить диапозон, и не забудтье поставить после точку с запятой.</p>

                        <p>Итак, формула теперь выглядит так:</p>
                        <pre class="code">=ВПР($А3;Лист4!$A:$H;номер_столбца;[интервальный просмотр])</pre>
                        <p>Номер столбца - числовое значение номера столбца в исходной таблице (табл. 2), откуда должен подтянуться наш факт. С учетом того, что первый столбец принадлежит уникальным данным - якорю, то данные, что нам нужны, находятся во втором столбце. Если в исходной таблице данные находятся ни во втором, а например, в десятом столбце, то соответственно, меняем цифру - номер столбца - на 10.
                        </p>
                        <pre class="code">=ВПР($А3;Лист4!$A:$H;2;[интервальный просмотр])</pre>

                        <p>Интервальный просмотр - принимает значение ИСТИНА (приблизительное значение), ЛОЖЬ (точное совпадение). Нам нужно точное совпадение и вместо ЛОЖЬ. Вместо ИСТИНА/ЛОЖЬ можно использовать числовой эквивалент 1/0 соответственно. Я советую без крайней необходимости не использовать приблизительное совпадение. Так что, ставим с гордостью 0 и закрываем круглую скобку. Данные в таблице 1 появились.</p>

                        <pre class="code">=ВПР($А3;Лист4!$A:$H;2;0)</pre>

                        <p>Теперь, протягиваем формулу вниз. Факт проставлен. Чтобы данные подтянулись в соседние столбцы, мы можем протянуть формулу, но не забудем поменять номер столбца. Так, в ячейке С3 таблицы 1 в формуле номер столбца будет уже не 2, а 3. В D5 - 4. И так далее. Можно вместо номера столбца, воспользоватья функцией СТОЛБЕЦ. Что ускорит работу. Об этой функции можно прочитать <a href="office-article4.html">здесь</a>. А сегодня мы разобрали все основные моменты, связанные с функцией ВПР. Буду рада, если Вам поможет эта статья. Если есть вопросы, <a href="index.html#footer-contacts">пишите</a>.</p>
                        </div>
                    </article>
                    
                </div>
    		</div>


    		<div class="footer">
        		<div class="social-links scrollflow -opacity">
    				<a href="https://www.facebook.com/anastasia.ekimova.3" target="_blank" class="fb"></a>
    	             <a href="https://vk.com/id812724" target="_blank" class="vk"></a>
    	             <a href="https://www.instagram.com/aasalikova/" target="_blank" class="insta"></a>
    	             <a href="https://twitter.com/AASalikova" target="_blank" class="tv"></a>
    			</div>
    			<div class="copyright scrollflow -opacity"><p>&#169; Anastasia Salikova 2017</p></div>
    		</div>
	    </div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="js/YouTubePopUp.jquery.js"></script>
	<script src="js/general.js"></script>
	<script src="js/eskju.jquery.scrollflow.js"></script>


	</body>
</html>