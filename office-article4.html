<!DOCTYPE HTML>
<html lang="ru">
	<head>
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-5QPB2DJ');</script>
        <!-- End Google Tag Manager -->
		<meta charset="utf-8">
			<title>В функции ВПР прописать номер столбца формулой</title>
			<link rel="stylesheet" type="text/css" href="css/reset.css">
			<link rel="stylesheet" type="text/css" href="css/style-main.css">
            <link rel="stylesheet" href="css/YouTubePopUp.css">
			<link rel="shortcut icon" href="images/minlogo.png" type="image/png">
			<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
            <meta name="keywords" content="эксель, формулы, ВПР, статьи, excel, office, СТОЛБЕЦ, функции">
            <meta name="description" content='В случае, когда с помощью функции ВПР необходимо "подтянуть" данные не с одного столбца, а с нескольких подряд, чтобы не проставлять номер столбца вручную, можно воспользоваться отличной функцией СТОЛБЕЦ.'>
	</head>
	<body>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5QPB2DJ"
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
		<div class="wrapper">
    		<div class="header">
    			<div class="logo"><a href="index.html"><img src="images/logo-main.png" alt="logo"></a></div>

    			<nav>
    			    <a class="menu-trigger">меню</a>
    				<ul>
                        <li><a href="photo-portfolio.html">фото портфолио</a></li>
                        <li><a href="adobe.html">тонкости Adobe</a></li>
                        <li><a href="office-works.html" class="active">работа с Office</a></li>
                        <li><a href="my-blog.html">Мой блог</a></li>
                        <li><a href="aboutIT.html">около IT</a></li>
                        <li><a href="qa.html">тестирование ПО</a></li>
                    </ul>
    			</nav>
    		</div>
		
    		<div class="content">
                <div class="wrap-office-article">
                    
                    <article class="office-articles">
                        <h2>В функции ВПР прописать номер столбца формулой</h2>
                        
                        <div class="full-text-article-office">
                        
                        <p>Есть таблица с данными (рис.1). В столбцы необходимо перенести данные из другой таблицы (рис.2). В графе "наименование" порядок и количество данных в двух таблицах не совпадает. Поэтому, воспользуемся формулой ВПР и перенесем все данные из столбцов с датами из таблицы 2 в таблицу 1. (<a href="office-article5.html">Подробнее о формуле ВПР)</a></p>
                        
                        <p><img src="images/articles/column1.jpg"></p>
                        <p class="caption">рис.1</p>
                        <p><img src="images/articles/column1-2.jpg"></p>
                        <p class="caption">рис.2</p>

                        <p>При написании формулы ВПР, номер столбца приходится указывать вручную. То есть, для каждого столбца свой номер от 2 до 9.</p>
                        <pre class="code">=ВПР($A2;Лист2!$A:$I;2;)</pre>
                        <p>Если таких столбцов, идущих подряд будет около 20-30? В каждом столбце менять одну цифру в формуле довольно долго и утомительно. В этом случае нам поможет доп. формула, которую мы включим в ВПР. Называется она СТОЛБЕЦ. Имеет вид:</p>
                        <pre class="code">=СТОЛБЕЦ([ссылка на столбец]);</pre>
                        <p>В квадратных скобках аргумент необязательный. Но в нашем примере необходимо указать ссылку на столбец - начало отсчета. На второй таблице видно, что данные мы будем возвращать, начиная с столбца В, закончим на I. Но, вручную пропишем только B, все остальное протянем.</p>
                        <p>Итак, в первой таблице в ячейке В2 пишем ВПР и вместо номера столбца "2" укажем СТОЛБЕЦ(B:B).</p>
                        <pre class="code">=ВПР($A2;Лист2!$A:$I;СТОЛБЕЦ(B:B);)</pre>
                        <p> Итог будет идентичен. Но если первый вариант формулы (с указанием номера столбца) мы протянем вправо, то формула будет копировать данные только со 2 столбца. А если мы воспользуемся формулой СТОЛБЕЦ, то при протягивании автоматически в формуле будет исправлена ссылка с B:B на диапозон С:C и так далее до I:I. Что очень удобно. И исключает ручную корректировку номера столбца.</p>
                        <p>Стоит отметить, что формула СТОЛБЕЦ может быть использована и в других ситуациях, она не является приложением к ВПР и считается самостоятельной. Но о других способах применения как-нибудь в другой раз.</p>
                        <p class="ps-text">Опубликовано: <time datetime="2017-04-26T23:05">26.04.2017</time></p>
                        </div>
                    </article>
                    
                </div>
    		</div>


    		<div class="footer">
        		<div class="social-links scrollflow -opacity">
    				<a href="https://www.facebook.com/anastasia.ekimova.3" target="_blank" class="fb"></a>
    	             <a href="https://vk.com/id812724" target="_blank" class="vk"></a>
    	             <a href="https://www.instagram.com/aasalikova/" target="_blank" class="insta"></a>
    	             <a href="https://twitter.com/AASalikova" target="_blank" class="tv"></a>
    			</div>
    			<div class="copyright scrollflow -opacity"><p>&#169; Anastasia Salikova 2017</p></div>
    		</div>
	    </div>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script type="text/javascript" src="js/YouTubePopUp.jquery.js"></script>
	<script src="js/general.js"></script>
	<script src="js/eskju.jquery.scrollflow.js"></script>


	</body>
</html>